(()=>{"use strict";const t=t=>Object.prototype.toString.call(t),e=e=>"[object Object]"===t(e),o=t=>"function"==typeof t,s=t=>"string"==typeof t,i=e=>{const o=t(e).match(/(HTML|Element)/g);let s="";return o&&(s=o.join("")),"HTMLElement"===s},r=e=>"[object Null]"===t(e),n=e=>"[object HTMLAudioElement]"===t(e),a=e=>"[object HTMLButtonElement]"===t(e),c=t=>void 0!==t,l=new class{constructor(){const t=document.querySelector("#navigation-modal");if(r(t))return;const e=t.querySelector(".voz [type='checkbox']");r(e)||"F"===this.obtener()&&e.setAttribute("checked","true")}obtener(){let t=localStorage.getItem("voz");return r(t)&&(t="M"),t}establecer(t){localStorage.setItem("voz",t)}establecerObtener(t){return this.establecer(t),this.obtener()}},d=new class{constructor(t){this.audio=document.createElement("audio"),this.audio.setAttribute("src",t),this.audio.setAttribute("loop","-1"),this.audio.volume=.25,this.obtenerPreferencia=()=>{let t=localStorage.getItem("reproducir");return r(t)&&(t="reproducir"),t},this.reproducir=t=>{i(t)&&(this.audio.play(),t.classList.add("audio--active"))},this.pausar=t=>{i(t)&&(this.audio.pause(),t.classList.remove("audio--active"))}}inicializar(t){let e=this.obtenerPreferencia();if("reproducir"===e&&this.audio.play(),!i(t))return;const o=t.querySelector("[data-toggle-music]");if(o){const t=o.parentNode;"reproducir"===e?this.reproducir(t):this.pausar(t)}}toggle(t){if(!i(t))return;const e=t.parentNode;let o=this.obtenerPreferencia();o="reproducir"===o?"no-reproducir":"reproducir",localStorage.setItem("reproducir",o),"reproducir"===o?this.reproducir(e):this.pausar(e)}pause(t){if(!i(t))return;const e=t.parentNode;this.pausar(e)}}("multimedia/audio/music/JoshWoodward-TheWake-NoVox-04-CrazyGlue.mp3"),u=new class{constructor(t){const{selectGame:e,selectWindow:o}=t;this.selectGame=e,this.selectWindow=o,this.estado=()=>{this.ventana.classList.remove("presentar--show","fadeOut"),document.body.removeAttribute("style")}}abrir(){const t=document.querySelector(this.selectGame),e=document.querySelector(this.selectWindow);r(t)||r(e)||t.addEventListener("click",(t=>{const o=t.target,{juego:s,href:r}=o.dataset,n=document.querySelector("#aviso");this.ventana=e,e.removeEventListener("animationend",this.estado),c(s)&&c(r)&&(i(n)&&(n.textContent=`${s}`),b.init(r,(function(){e.classList.add("presentar--show")})),document.body.setAttribute("style","overflow: hidden"))}))}salir(){const t=document.querySelector(this.selectWindow);r(t)||(this.ventana=t,t.classList.add("fadeOut"),t.addEventListener("animationend",this.estado))}establecer(t){this.path=t}}({selectGame:".juegos",selectWindow:"#presentar-simbolos"}),h=e=>{const{selectorNav:o="#navigation-modal",selectorVentanaModal:s="#presentar-simbolos"}=e,i=document.querySelector(s);if(r(i))return;const n=i.querySelector(o);r(n)||(d.inicializar(n),n.onclick=e=>{const o=e.target,{toggleMusic:s,salir:r}=o.dataset;if((e=>"[object HTMLInputElement]"===t(e))(n=o)&&"checkbox"===n.getAttribute("type")){const t=o.checked?"F":"M";l.establecer(t)}var n;c(r)&&(document.body.removeAttribute("style"),i.classList.add("fadeOut"),u.salir(),d.pause(o)),c(s)&&d.toggle(o)})},m=new class{constructor(){}obtener(){let t=localStorage.getItem("tipo");return r(t)&&(t="numero"),t}establecer(t){localStorage.setItem("tipo",s(t)?t:null)}},p={},b=new class{constructor(){this.datos=[],this.simbolos={},this.controls=[],this.audio=document.createElement("audio"),this.soundTab=document.createElement("audio"),this.pintarTeclado=()=>{const{datos:t,simbolos:o}=p;if(!e(t)&&!e(o))return;const{menu:s}=o,i=document.querySelector("#pestannas"),d=document.querySelector("#letra");if(r(d))return;const u=document.querySelector("#teclado");if(r(u))return;const h=()=>{const e=m.obtener();let o="";return t.forEach((t=>{var s;e===t.tipo&&(o+=`<button class="teclas__item ${(s=t).className}" data-simbolo="${s.letra}"><span>${s.letra}</span></button>`)})),o};if(!c(p.menuAudio)&&e(s)){p.menuAudio=s;const{menuAudio:t}=p;for(let o in t){const s=t[o];if(e(s))for(let t in s){const e=s[t],o=this.soundTab.cloneNode(!1);o.setAttribute("src",e),s[t]=o}}}const b=document.createElement("div");b.classList.add("teclas"),u.textContent="",u.append(b),b.innerHTML=h(),r(i)||i.addEventListener("click",(t=>{const e=t.target;if(!a(e))return;const{tipo:o}=e.dataset;if(c(o)){b.innerHTML=h();const t=s[o];if(!c(t))return;const e=l.obtener();if(!n(t[e]))return;t[e].play()}}),!1),b.addEventListener("click",(t=>{const e=t.target,o=l.obtener();if(!a(e))return;const{simbolo:s}=e.dataset,i=this.simbolos,r=i[s].audio[o];if(!n(r))return;r.play();const c=i[s].simbolo,u=i[s].className;d.innerHTML=((t,e)=>`<div class="simbolo__item ${t}">${e}</div>`)(u,c)}))},this.nav=()=>{h("#navigation-modal")}}async init(t,r){if(!s(t))return;if(c(p.datos&&c(p.simbolos)))return this.pintarTeclado(),void(o(r)&&(r(),this.nav()));const n=document.querySelector("#loading");i(n)&&n.classList.remove("none");const a=await fetch(t),l=await a.json(),d=[];for(let t in l){const o=l[t].audio;if(e(o))for(let t in o){const e=this.audio.cloneNode(!1);e.setAttribute("src",o[t]),o[t]=e}const s=l[t];if(!c(s.simbolo))continue;fetch(s.simbolo).then((t=>t.text())).then((t=>{s.simbolo=t})),d.push(s.simbolo);const i=l[t];c(i.letra)&&(i.letras=i.letra,i.letra=t),this.datos.push(l[t])}Promise.all(d).then((()=>{d.length=0,this.simbolos=l,p.datos=this.datos,p.simbolos=this.simbolos,o(r)&&setTimeout((()=>{this.pintarTeclado(),r(),i(n)&&n.classList.add("none")}),500),this.nav()}))}},f=new class{constructor(t){this.selector=t,this.pestanna=document.querySelector(t),r(this.pestanna)||(this.buttons=this.pestanna.querySelectorAll("button"),this.deseleccionar=()=>{this.buttons.forEach((t=>{t.classList.remove("pestannas__button--seleccionado")}))},this.preferencia=()=>{let t=localStorage.getItem("tipo");return r(t)&&(t="numero"),t},this.seleccionado=()=>{const t=this.preferencia();this.buttons.forEach((e=>{const{tipo:o}=e.dataset;c(o)&&o===t&&e.classList.add("pestannas__button--seleccionado")}))},this.seleccionado())}seleccionar(){const t=document.querySelector(this.selector),e=document.querySelectorAll(this.selector+" button");r(t)||t.addEventListener("click",(t=>{const o=t.target;if(a(o)){const{sonido:t,tipo:s}=o.dataset;if(!c(t)||!c(s))return void console.log("Debes definir data-sonido y data-tipo en los botones de la pestaÃ±a");localStorage.setItem("tipo",s),e.forEach((t=>{t.classList.remove("pestannas__button--seleccionado")})),o.classList.add("pestannas__button--seleccionado")}}),!1)}}(".pestannas");(new class{constructor(t="#app"){this.claves=/{{([^}]*)}}/g,this.eliminarLlaves=t=>t.replace(/([\{\}])/g,"").trim(),this.app=document.querySelector(t),this.variables={},this.tokens=[],this.content=this.app.innerHTML,this.extraerDatos=()=>{const t=this.content;if(!t.length>0)return this.tokens;const e=t.match(this.claves);if(!Array.isArray(e))return this.tokens;e.forEach((t=>{this.tokens.push({expresion:t,propiedad:this.eliminarLlaves(t)})}))},this.procesarExpresiones=()=>{this.tokens.forEach((t=>{if(void 0===this.variables[t.propiedad])throw new TypeError('Debe definir "'+t.propiedad+'" para poder usarla');this.content=this.content.replace(t.expresion,this.variables[t.propiedad])})),this.app.innerHTML=this.content},this.init=()=>{this.extraerDatos(),this.procesarExpresiones()}}render(t){this.variables=t(),this.init()}}).render((()=>({letra:"A",autor:"David E Luna M",title:"Aprendiendo",indicaciones:"Escuchando lecciones",musica:"multimedia/audio/music/JoshWoodward-TheWake-NoVox-04-CrazyGlue.mp3",teclado:"multimedia/icons/teclado.svg",logo:"multimedia/icons/logo.svg","marca-de-agua":"multimedia/logos/favicon-variante.svg","letras-numeros":"recursos/api/simbolos.json"}))),("[data-src$='.svg']",document.querySelectorAll("[data-src$='.svg']")).forEach((t=>{fetch(t.dataset.src).then((function(t){return t.text()})).then((function(e){t.innerHTML=e.replace(/((\<script\D?)+[^\<]*(\<\/script?\D|\>?)*)/gim,""),t.removeAttribute("data-src")}))})),document.querySelectorAll("[href$='#']").forEach((t=>{t.addEventListener("click",(t=>{t.preventDefault()}))})),f.seleccionar(),u.abrir()})();